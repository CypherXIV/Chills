{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrahead %}
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center align-items-center" style="height:100vh">
        <div class="col-md-4">
            <h1 class="text-center mb-4">Administrator Login</h1>
            <!-- Update the form action to point to custom_admin_login view -->
            <form method="post" action="{% url 'custom_admin_login' %}">
                {% csrf_token %}
                <!-- User ID Field -->
                <div class="mb-3">
                    <label for="user_id" class="form-label">User ID</label>
                    <input type="text" name="user_id" class="form-control" required>
                </div>
                <!-- Username Field -->
                <div class="mb-3">
                    <label for="username" class="form-label">Username</label>
                    <input type="text" name="username" class="form-control" required>
                </div>
                <!-- PIN Field -->
                <div class="mb-3">
                    <label for="pin" class="form-label">PIN</label>
                    <input type="password" name="pin" class="form-control" maxlength="4" pattern="\d{4}" required>
                    <div class="form-text">Enter your 4-digit PIN.</div>
                </div>
                <!-- Password Field -->
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" name="password" class="form-control" required>
                </div>
                <!-- Submit Button -->
                <div class="mb-3">
                    <input type="submit" value="Login" class="btn btn-primary w-100">
                </div>
            </form>
            <!-- Create New Account Button -->
            <button type="button" class="btn btn-secondary w-100 mb-2" data-bs-toggle="modal" data-bs-target="#createAccountModal">Create New Account</button>
            <!-- Simulated Card and Fingerprint Reader Buttons -->
            <button type="button" onclick="simulateCardReader()" class="btn btn-secondary w-100 mb-2">Use Card Reader</button>
            <button type="button" onclick="simulateFingerprintReader()" class="btn btn-secondary w-100">Use Fingerprint Reader</button>
        </div>
    </div>
</div>

<!-- Create Account Modal -->
<div class="modal fade" id="createAccountModal" tabindex="-1" aria-labelledby="createAccountModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createAccountModalLabel">Create New Account</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{% url 'create_user' %}">
                    {% csrf_token %}
                    <!-- Fields for account creation -->
                    <!-- User ID Field -->
                    <div class="mb-3">
                        <label for="user_id" class="form-label">User ID</label>
                        <input type="text" name="user_id" class="form-control" required>
                    </div>
                    <!-- Username Field -->
                    <div class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" name="username" class="form-control" required>
                    </div>
                    <!-- PIN Field -->
                    <div class="mb-3">
                        <label for="pin" class="form-label">PIN</label>
                        <input type="password" name="pin" class="form-control" maxlength="4" pattern="\d{4}" required>
                        <div class="form-text">Enter your 4-digit PIN.</div>
                    </div>
                    <!-- Password Field -->
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" name="password" class="form-control" required>
                    </div>
                    <!-- Role Field -->
                    <div class="mb-3">
                        <label for="role" class="form-label">Role</label>
                        <select name="role" class="form-control" required>
                            <option value="{{ UserRole.MANAGER }}">Manager</option>
                            <option value="{{ UserRole.STAFF }}">Staff</option>
                            <option value="{{ UserRole.CLIENT }}">Client</option>
                        </select>
                    </div>
                    <!-- Submit Button -->
                    <div class="mb-3">
                        <input type="submit" value="Create Account" class="btn btn-primary w-100">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Include Bootstrap JavaScript library -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>


<script>
    function simulateCardReader() {
        // Simulate a delay for card reading
        setTimeout(function() {
            alert('Card Reader: Authentication Successful!');
            // Redirect to the admin dashboard or another page
            window.location.href = "/admin/";
        }, 2000);  // 2-second delay
    }

    function simulateFingerprintReader() {
        // Simulate a delay for fingerprint reading
        setTimeout(function() {
            alert('Fingerprint Reader: Authentication Successful!');
            // Redirect to the admin dashboard or another page
            window.location.href = "/admin/";
        }, 2000);  // 2-second delay
    }
</script>
{% endblock %}
